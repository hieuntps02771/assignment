jQuery.autocomplete=function(i,a){function o(){j={};j.data={};j.length=0}function C(b){var c=$("li",p);if(c){m+=b;if(m<0)m=0;else if(m>=c.size())m=c.size()-1;c.removeClass("ac_over");$(c[m]).addClass("ac_over")}}function J(){var b=$("li.ac_over",p)[0];if(!b){var c=$("li",p);if(a.selectOnly){if(c.length==1)b=c[0]}else if(a.selectFirst)b=c[0]}if(b){y(b);return true}else return false}function y(b){if(!b){b=document.createElement("li");b.extra=[];b.selectValue=""}var c=$.trim(b.selectValue?b.selectValue:
b.innerHTML);r=i.lastSelected=c;l.html("");h.val(c);s();a.onItemSelect&&setTimeout(function(){a.onItemSelect(b)},1)}function s(){n&&clearTimeout(n);h.removeClass(a.loadingClass);l.is(":visible")&&l.hide();a.mustMatch&&h.val()!=i.lastSelected&&y(null)}function D(b,c){if(c){h.removeClass(a.loadingClass);p.innerHTML="";if(!z||c.length==0)return s();$.browser.msie&&l.append(document.createElement("iframe"));p.appendChild(K(c));if(a.autoFill&&h.val().toLowerCase()==b.toLowerCase()){var d=c[0][0];if(t!=
8){h.val(h.val()+d.substring(r.length));var e=r.length;d=d.length;var g=h.get(0);if(g.createTextRange){var f=g.createTextRange();f.collapse(true);f.moveStart("character",e);f.moveEnd("character",d);f.select()}else if(g.setSelectionRange)g.setSelectionRange(e,d);else if(g.selectionStart){g.selectionStart=e;g.selectionEnd=d}g.focus()}}e=i;d=e.offsetLeft||0;for(g=e.offsetTop||0;e=e.offsetParent;){d+=e.offsetLeft;g+=e.offsetTop}e={x:d,y:g};d=a.width>0?a.width:h.width();l.css({width:parseInt(d)+"px",top:e.y+
i.offsetHeight+"px",left:e.x+"px"}).show()}else s()}function E(b){if(!b)return null;var c=[];b=b.split(a.lineSeparator);for(var d=0;d<b.length;d++){var e=$.trim(b[d]);if(e)c[c.length]=e.split(a.cellSeparator)}return c}function K(b){var c=document.createElement("ul"),d=b.length;if(a.maxItemsToShow>0&&a.maxItemsToShow<d)d=a.maxItemsToShow;for(var e=0;e<d;e++){var g=b[e];if(g){var f=document.createElement("li");f.innerHTML=a.formatItem?a.formatItem(g,e,d):g[0];f.selectValue=g[0];var k=null;if(g.length>
1){k=[];for(var q=1;q<g.length;q++)k[k.length]=g[q]}f.extra=k;c.appendChild(f);$(f).hover(function(){$("li",c).removeClass("ac_over");$(this).addClass("ac_over");m=$("li",c).indexOf($(this).get(0))},function(){$(this).removeClass("ac_over")}).click(function(F){F.preventDefault();F.stopPropagation();y(this)})}}return c}function L(b){a.matchCase||(b=b.toLowerCase());var c=a.cacheLength?G(b):null;if(c)D(b,c);else typeof a.url=="string"&&a.url.length>0?$.get(H(b),function(d){d=E(d);A(b,d);D(b,d)}):h.removeClass(a.loadingClass)}
function H(b){b=a.url+"&q="+encodeURI(b);for(var c in a.extraParams)b+="&"+c+"="+encodeURI(a.extraParams[c]);return b}function G(b){if(!b)return null;if(j.data[b])return j.data[b];if(a.matchSubset)for(var c=b.length-1;c>=a.minChars;c--){var d=b.substr(0,c);if(d=j.data[d]){c=[];for(var e=0;e<d.length;e++){var g=d[e],f;f=g[0];var k=b;a.matchCase||(f=f.toLowerCase());f=f.indexOf(k);f=f==-1?false:f==0||a.matchContains;if(f)c[c.length]=g}return c}}return null}function B(b,c){c&&h.removeClass(a.loadingClass);
for(var d=c?c.length:0,e=null,g=0;g<d;g++){var f=c[g];if(f[0].toLowerCase()==b.toLowerCase()){e=document.createElement("li");e.innerHTML=a.formatItem?a.formatItem(f,g,d):f[0];e.selectValue=f[0];var k=null;if(f.length>1){k=[];for(var q=1;q<f.length;q++)k[k.length]=f[q]}e.extra=k}}a.onFindValue&&setTimeout(function(){a.onFindValue(e)},1)}function A(b,c){if(!(!c||!b||!a.cacheLength)){if(!j.length||j.length>a.cacheLength){o();j.length++}else j[b]||j.length++;j.data[b]=c}}var h=$(i).attr("autocomplete",
"off");a.inputClass&&h.addClass(a.inputClass);var p=document.createElement("div"),l=$(p);l.hide().addClass(a.resultsClass).css("position","absolute");a.width>0&&l.css("width",a.width);$("body").append(p);i.autocompleter=this;var n=null,r="",m=-1,j={},z=false,t=null;o();if(a.data!=null){var w="",u={},x=[];if(typeof a.url!="string")a.cacheLength=1;for(var v=0;v<a.data.length;v++){x=typeof a.data[v]=="string"?[a.data[v]]:a.data[v];if(x[0].length>0){w=x[0].substring(0,1).toLowerCase();u[w]||(u[w]=[]);
u[w].push(x)}}for(var I in u){a.cacheLength++;A(I,u[I])}}h.keydown(function(b){t=b.keyCode;switch(b.keyCode){case 38:b.preventDefault();C(-1);break;case 40:b.preventDefault();C(1);break;case 9:case 13:if(J()){h.get(0).blur();b.preventDefault()}break;default:m=-1;n&&clearTimeout(n);n=setTimeout(function(){if(t==46||t>8&&t<32)l.hide();else{var c=h.val();if(c!=r){r=c;if(c.length>=a.minChars){h.addClass(a.loadingClass);L(c)}else{h.removeClass(a.loadingClass);l.hide()}}}},a.delay)}}).focus(function(){z=
true}).blur(function(){z=false;n&&clearTimeout(n);n=setTimeout(s,200)});s();this.flushCache=function(){o()};this.setExtraParams=function(b){a.extraParams=b};this.findValue=function(){var b=h.val();a.matchCase||(b=b.toLowerCase());var c=a.cacheLength?G(b):null;if(c)B(b,c);else typeof a.url=="string"&&a.url.length>0?$.get(H(b),function(d){d=E(d);A(b,d);B(b,d)}):B(b,null)}};
jQuery.fn.autocomplete=function(i,a,o){a=a||{};a.url=i;a.data=typeof o=="object"&&o.constructor==Array?o:null;a.inputClass=a.inputClass||"ac_input";a.resultsClass=a.resultsClass||"ac_results";a.lineSeparator=a.lineSeparator||"\n";a.cellSeparator=a.cellSeparator||"|";a.minChars=a.minChars||1;a.delay=a.delay||400;a.matchCase=a.matchCase||0;a.matchSubset=a.matchSubset||1;a.matchContains=a.matchContains||0;a.cacheLength=a.cacheLength||1;a.mustMatch=a.mustMatch||0;a.extraParams=a.extraParams||{};a.loadingClass=
a.loadingClass||"ac_loading";a.selectFirst=a.selectFirst||false;a.selectOnly=a.selectOnly||false;a.maxItemsToShow=a.maxItemsToShow||-1;a.autoFill=a.autoFill||false;a.width=parseInt(a.width,10)||0;this.each(function(){new jQuery.autocomplete(this,a)});return this};jQuery.fn.autocompleteArray=function(i,a){return this.autocomplete(null,a,i)};jQuery.fn.indexOf=function(i){for(var a=0;a<this.length;a++)if(this[a]==i)return a;return-1};